<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de precios</title>
  <style>
    :root{--bg:#0b0f14;--panel:#121822;--muted:#9fb0c7;--text:#e6edf6;--accent:#4aa8ff}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;background:var(--bg);color:var(--text)}
    .wrap{max-width:920px;margin:32px auto;padding:16px}
    .card{background:var(--panel);border:1px solid #1f2733;border-radius:16px;box-shadow:0 6px 24px rgba(0,0,0,.35);overflow:hidden}
    header{padding:18px 20px;border-bottom:1px solid #1f2733;display:flex;gap:12px;align-items:center;justify-content:space-between}
    header h1{font-size:20px;margin:0}
    .chip{font-size:12px;padding:3px 8px;border-radius:999px;background:#0d1320;border:1px solid #1f2733;color:#9fb0c7}
    .bar{padding:14px 20px;border-bottom:1px solid #1f2733;display:flex;gap:12px;align-items:center}
    .bar input{flex:1;padding:12px 11px;border-radius:10px;border:1px solid #1f2733;background:#0d1320;color:var(--text);outline:none}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;padding:20px}
    @media (max-width:720px){.grid{grid-template-columns:1fr}}
    label{font-size:12px;color:var(--muted);display:block;margin:0 0 6px 2px}
    select,input{width:100%;padding:12px 11px;border-radius:10px;border:1px solid #1f2733;background:#0d1320;color:var(--text);outline:none}
    select:focus,input:focus{border-color:var(--accent)}
    .hint{font-size:12px;color:var(--muted)}
    .hidden{display:none}
    .total{padding:18px 20px;border-top:1px solid #1f2733;display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
    .pill{display:inline-block;background:rgba(74,168,255,.1);border:1px solid rgba(74,168,255,.35);color:#b8d8ff;padding:4px 8px;border-radius:999px;font-size:12px}
    .kpi{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:10px}
    .box{background:#0d1320;border:1px solid #1f2733;border-radius:12px;padding:12px}
    .box h4{margin:0 0 4px 0;font-size:12px;color:#9fb0c7}
    .box .v{font-weight:700}
    .num{font-size:28px;font-weight:700}
    .btn{background:var(--accent);color:#001428;border:none;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    .footer{padding:16px 20px;display:flex;flex-direction:column;gap:10px;color:#9fb0c7;font-size:12px;line-height:1.5}
    .fx{display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:end}
    @media (max-width:720px){.fx{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="app">
      <header>
        <h1>Calculadora de precios – Camisetas</h1>
        <span class="chip">v10</span>
      </header>

      <!-- Barra principal de texto -->
      <div class="bar">
        <label for="descripcion" class="hint" style="min-width:130px;margin:0">Descripción</label>
        <input id="descripcion" type="text" placeholder="Ej: Boca Local 24/25" />
      </div>

      <div class="grid">
        <div>
          <label for="marca">Marca</label>
          <select id="marca">
            <option value="">(Elegir)</option>
            <option value="Adidas">Adidas</option>
            <option value="Nike">Nike</option>
            <option value="Otro">Otro</option>
          </select>
          <div class="hint" id="marcaHint">Se ignora si la Temporada es Retro o si la Versión es Fan.</div>
        </div>

        <div>
          <label for="version">Versión</label>
          <select id="version">
            <option value="">(Elegir)</option>
            <option value="Fan">Fan</option>
            <option value="Jugador">Jugador</option>
          </select>
          <div class="hint" id="versionHint">Si elegís Fan, la marca no afecta el precio.</div>
        </div>

        <div>
          <label for="temporada">Temporada</label>
          <select id="temporada">
            <option value="Actual">Actual</option>
            <option value="Retro">Retro</option>
          </select>
        </div>

        <div>
          <label for="talle">Talle</label>
          <select id="talle">
            <option value="">(Elegir)</option>
            <option value="XS">XS</option>
            <option value="S">S</option>
            <option value="M">M</option>
            <option value="L">L</option>
            <option value="XL">XL</option>
            <option value="2XL">2XL (+1)</option>
            <option value="3XL">3XL (+1)</option>
            <option value="4XL">4XL (+1)</option>
          </select>
          <div class="hint">En talles 2XL/3XL/4XL se suma +1.</div>
        </div>

        <div>
          <label for="dorsal">Dorsal</label>
          <select id="dorsal">
            <option value="">Ninguno</option>
            <option value="Jugador">Jugador (+1)</option>
            <option value="Personalizada">Personalizada (+3)</option>
          </select>
        </div>

        <!-- Campos extras y especificación (DEBAJO de los inputs) -->
        <div id="camposExtras" class="hidden">
          <label for="numero">Número</label>
          <input id="numero" type="text" placeholder="Ej: 10" />
          <label for="nombre">Nombre</label>
          <input id="nombre" type="text" placeholder="Ej: Messi" />
          <div id="dorsalInfo" class="hint" style="margin-top:6px"></div>
        </div>

        <div>
          <label for="parches">Parches</label>
          <select id="parches">
            <option value="NO">NO</option>
            <option value="SI">SI (+1)</option>
          </select>
          <div id="parcheBox" class="hidden" style="margin-top:8px">
            <label for="parcheTexto">Competición</label>
            <input id="parcheTexto" type="text" placeholder="Ej: Champions, Libertadores, Premier..." />
          </div>
        </div>

        <!-- Tipo de cambio (opcional) -->
        <div class="fx">
          <div>
            <label for="fx">Tipo de cambio (opcional)</label>
            <input id="fx" type="number" step="0.01" min="0" placeholder="Ej: 1234.00 (ARS por USD)" />
            <div class="hint">Si lo completás, se calcula el total en ARS.</div>
          </div>
          <div>
            <label>&nbsp;</label>
            <div class="box">
              <h4>Total ARS</h4>
              <div class="v" id="total_ars">—</div>
            </div>
          </div>
        </div>
      </div>

      <div class="total">
        <div>
          <div class="pill" id="tag"></div>
          <div class="kpi">
            <div class="box"><h4>Base</h4><div class="v" id="v_base">US$ 0,00</div></div>
            <div class="box"><h4>Extras</h4><div class="v" id="v_extras">US$ 0,00</div></div>
            <div class="box"><h4>Gastos</h4><div class="v" id="v_gastos">US$ 3,75</div></div>
          </div>
        </div>
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
          <div class="num" id="total">US$ 0,0</div>
          <button class="btn" id="copy">Copiar total</button>
          <button class="btn" id="copyBoth" title="Copia USD y ARS (si hay tipo de cambio)">Copiar USD/ARS</button>
        </div>
      </div>

      <div class="footer">
        <div>• Versión: <b>Fan = US$ 10</b>. <b>Jugador</b> = Adidas 13 / Nike 14 / <b>Otro 13</b>.</div>
        <div>• Temporada Retro: <b>+US$ 15</b> (ignora Versión y Marca).</div>
        <div>• Talles: <b>2XL / 3XL / 4XL = +1</b>.</div>
        <div>• Dorsal: <b>Jugador +1</b>, <b>Personalizada +3</b> (se habilitan campos Número y Nombre; explicación debajo).</div>
        <div>• Parches: <b>SI +1</b> (si se elige, indicar competición).</div>
        <div>• Gastos variados (USD): <b>EMS = 2,5</b> · <b>Correo Argentino = 1,25</b>.</div>
        <div>• Todos los valores en <b>USD</b>.</div>
      </div>
    </div>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);
    const els = {
      descripcion: $("descripcion"),
      marca: $("marca"), version: $("version"), temporada: $("temporada"),
      talle: $("talle"),
      dorsal: $("dorsal"), numero: $("numero"), nombre: $("nombre"),
      camposExtras: $("camposExtras"), dorsalInfo: $("dorsalInfo"),
      parches: $("parches"), parcheBox: $("parcheBox"), parcheTexto: $("parcheTexto"),
      total: $("total"), v_base: $("v_base"), v_extras: $("v_extras"), v_gastos: $("v_gastos"),
      tag: $("tag"), copy: $("copy"), copyBoth: $("copyBoth"),
      marcaHint: $("marcaHint"), versionHint: $("versionHint"),
      fx: $("fx"), total_ars: $("total_ars")
    };

    const KEYS = [
      "descripcion","marca","version","temporada","talle","dorsal",
      "numero","nombre","parches","parcheTexto","fx"
    ];

    const formatUSD = (n) => 'US$ ' + n.toLocaleString('es-AR',{minimumFractionDigits:2, maximumFractionDigits:2});
    const formatUSDSmall = (n) => 'US$ ' + n.toLocaleString('es-AR',{minimumFractionDigits:1, maximumFractionDigits:1});
    const formatARS = (n) => '$ ' + n.toLocaleString('es-AR',{minimumFractionDigits:0, maximumFractionDigits:0});

    function calcBase(marca, version, temporada) {
      if (temporada === "Retro") return 15;         // Retro ignora versión y marca
      if (version === "Fan") return 10;             // Fan ignora marca
      if (version === "Jugador") {                  // Jugador depende de marca
        if (marca === "Adidas") return 13;
        if (marca === "Nike") return 14;
        if (marca === "Otro") return 13;
      }
      return 0;
    }

    function extraTalle(talle) {
      return (talle === "2XL" || talle === "3XL" || talle === "4XL") ? 1 : 0;
    }

    function saveState(){
      const state = {};
      KEYS.forEach(k => state[k] = els[k]?.value ?? "");
      try { localStorage.setItem("calcCamisetaV10", JSON.stringify(state)); } catch {}
    }

    function loadState(){
      try {
        const raw = localStorage.getItem("calcCamisetaV10");
        if(!raw) return;
        const s = JSON.parse(raw);
        KEYS.forEach(k => { if(els[k] && s[k]!=null) els[k].value = s[k]; });
      } catch {}
    }

    function calc() {
      // Fijos (USD)
      const correo = 1.25;
      const ems    = 2.5;

      const temporada = els.temporada.value;
      const version   = els.version.value;
      const marca     = els.marca.value;
      const talle     = els.talle.value;
      const dorsal    = els.dorsal.value;
      const parches   = els.parches.value;
      const fxRate    = parseFloat(els.fx.value || "0");

      // Estado dinámico selects
      if (temporada === 'Retro') {
        els.version.disabled = true;
        els.marca.disabled = true;
        if (els.version.value) els.version.value = ""; // limpiar si estaba seteado
        if (els.marca.value) els.marca.value = "";     // limpiar si estaba seteado
        els.marcaHint.textContent = 'Ignorada por Retro';
        els.versionHint.textContent = 'Ignorada por Retro';
      } else {
        els.version.disabled = false;
        const isFan = (version === 'Fan');
        els.marca.disabled = isFan; // si Fan, la marca se ignora
        if (isFan && els.marca.value) els.marca.value = ""; // limpiar marca al pasar a Fan
        els.marcaHint.textContent = isFan ? 'Ignorada por Versión = Fan' : 'Activa';
        els.versionHint.textContent = isFan ? 'Fan: la marca no afecta el precio.' : 'Jugador: precio según marca.';
      }

      // Dorsal: campos y explicación debajo
      if (dorsal === 'Jugador' || dorsal === 'Personalizada') {
        els.camposExtras.classList.remove('hidden');
        if (dorsal === 'Jugador') {
          els.dorsalInfo.classList.remove('hidden');
          els.dorsalInfo.innerHTML = 'Dorsal <b>Jugador</b>: se usa el número y nombre oficiales de un jugador real del equipo.';
        } else {
          els.dorsalInfo.classList.remove('hidden');
          els.dorsalInfo.innerHTML = 'Dorsal <b>Personalizada</b>: podés elegir el número y el nombre que quieras.';
        }
      } else {
        els.camposExtras.classList.add('hidden');
        els.dorsalInfo.classList.add('hidden');
        els.dorsalInfo.innerHTML = '';
        els.numero.value = '';
        els.nombre.value = '';
      }

      // Parches: campo competición si = SI
      if (parches === 'SI') {
        els.parcheBox.classList.remove('hidden');
      } else {
        els.parcheBox.classList.add('hidden');
        els.parcheTexto.value = '';
      }

      // Cálculos
      const base   = calcBase(marca, version, temporada);
      let extras   = 0;

      // Extras por dorsal
      if (dorsal === 'Jugador') extras += 1;
      else if (dorsal === 'Personalizada') extras += 3;

      // Extras por parches
      if (parches === 'SI') extras += 1;

      // Extras por talle
      extras += extraTalle(talle);

      // Gastos fijos
      const gastos = correo + ems; // 1,25 + 2,5 = 3,75

      const total  = base + extras + gastos;

      // UI USD
      els.v_base.textContent   = formatUSD(base);
      els.v_extras.textContent = formatUSD(extras);
      els.v_gastos.textContent = formatUSD(gastos);
      els.total.textContent    = formatUSDSmall(total);

      // Tag
      if (temporada === 'Retro') {
        els.tag.textContent = `Temporada: Retro (marca/versión ignoradas) · ${els.descripcion.value || '—'}`;
      } else if (version === 'Fan') {
        els.tag.textContent = `Versión: Fan (marca ignorada) · ${els.descripcion.value || '—'}`;
      } else if (version === 'Jugador') {
        els.tag.textContent = `Versión: Jugador · Marca: ${marca || '—'} · ${els.descripcion.value || '—'}`;
      } else {
        els.tag.textContent = `${els.descripcion.value || '—'}`;
      }

      // ARS opcional
      if (!isNaN(fxRate) && fxRate > 0) {
        const ars = Math.round(total * fxRate);
        els.total_ars.textContent = formatARS(ars);
      } else {
        els.total_ars.textContent = '—';
      }

      // Guardar
      saveState();
    }

    // Eventos
    ['change','input'].forEach(ev=>{
      [
        'descripcion','marca','version','temporada','talle',
        'dorsal','parches','numero','nombre','parcheTexto','fx'
      ].forEach(id => {
        const el = document.getElementById(id);
        el && el.addEventListener(ev, calc);
      });
    });

    // Copiar
    els.copy.addEventListener('click', ()=>{
      navigator.clipboard.writeText(els.total.textContent).then(()=>{
        els.copy.textContent = 'Copiado';
        setTimeout(()=> els.copy.textContent = 'Copiar total', 1500);
      });
    });

    els.copyBoth.addEventListener('click', ()=>{
      const usd = els.total.textContent;
      const ars = els.total_ars.textContent !== '—' ? ` · ${els.total_ars.textContent}` : '';
      navigator.clipboard.writeText(`${usd}${ars}`).then(()=>{
        els.copyBoth.textContent = 'Copiado';
        setTimeout(()=> els.copyBoth.textContent = 'Copiar USD/ARS', 1500);
      });
    });

    // init
    loadState();
    calc();
  </script>
</body>
</html>
